<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcoapy: libcoapy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libcoapy
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">libcoapy </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p>libcoapy project enables communication over the CoAP protocol (RFC 7252). The <code>llapi</code> module provides ctypes-based wrappers for the <a href="https://libcoap.net/">libcoap</a> C library. The <code>libcoapy</code> module uses <code>llapi</code> to provide a high-level class interface to the libcoap functions.</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Dependencies:</h1>
<ul>
<li><a href="https://libcoap.net/">libcoap</a> (v4.3.5 or higher is recommended)</li>
<li><a href="https://pypi.org/project/ifaddr/">ifaddr</a> (optional, to query all IPs of an interface)</li>
<li><a href="https://pypi.org/project/netifaces/">netifaces</a> (optional alternative to ifaddr)</li>
</ul>
<h1><a class="anchor" id="autotoc_md1"></a>
Status</h1>
<p>The llapi module provides a complete interface for the current version of the libcoap library. The high-level API of libcoapy is still missing some parts and might change in the future.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Portability</h1>
<p>libcoapy is a pure python module and the underlying libcoap supports several platforms like Linux, Windows, MacOS and Android. However, libcoap (and hence libcoapy) does not support all features on all platforms and with all possible SSL/TLS libraries.</p>
<p>If you want to use libcoapy with asyncio on platforms without epoll, like Windows, it might be necessary to choose an event loop that supports <code>add_reader()</code>. On Windows you might need to add this to your code before initializing the loop:</p>
<div class="fragment"><div class="line">if sys.version_info[0] == 3 and sys.version_info[1] &gt;= 8 and sys.platform.startswith(&#39;win&#39;):</div>
<div class="line">    asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3"></a>
Provided tools</h1>
<p>In the examples folder, this repo provides the following general-purpose tools:</p>
<ul>
<li>coap-gui - a small Tkinter-based GUI to interact with a CoAP server</li>
<li>coarl - a CLI tool that provides a similar interface as <a href="https://curl.se/">curl</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Example: client</h1>
<div class="fragment"><div class="line"><span class="keyword">from</span> libcoapy <span class="keyword">import</span> *</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> len(sys.argv) &lt; 2:</div>
<div class="line">    uri_str = <span class="stringliteral">&quot;coap://localhost&quot;</span></div>
<div class="line"><span class="keywordflow">else</span>:</div>
<div class="line">    uri_str = sys.argv[1]</div>
<div class="line"> </div>
<div class="line">ctx = CoapContext()</div>
<div class="line"> </div>
<div class="line">session = ctx.newSession(uri_str)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>rx_cb(session, tx_msg, rx_msg, mid):</div>
<div class="line">    print(rx_msg.payload)</div>
<div class="line">    session.ctx.stop_loop()</div>
<div class="line"> </div>
<div class="line">session.sendMessage(path=<span class="stringliteral">&quot;.well-known/core&quot;</span>, response_callback=rx_cb)</div>
<div class="line"> </div>
<div class="line">ctx.loop()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Example: server</h1>
<div class="fragment"><div class="line"><span class="keyword">from</span> libcoapy <span class="keyword">import</span> *</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>echo_handler(resource, session, request, query, response):</div>
<div class="line">    response.payload = request.payload</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>time_handler(resource, session, request, query, response):</div>
<div class="line">    <span class="keyword">import</span> datetime</div>
<div class="line">    now = datetime.datetime.now()</div>
<div class="line">    response.payload = str(now)</div>
<div class="line"> </div>
<div class="line">ctx = CoapContext()</div>
<div class="line">ctx.addEndpoint(<span class="stringliteral">&quot;coap://[::]&quot;</span>)</div>
<div class="line"> </div>
<div class="line">time_rs = CoapResource(ctx, <span class="stringliteral">&quot;time&quot;</span>)</div>
<div class="line">time_rs.addHandler(time_handler)</div>
<div class="line">ctx.addResource(time_rs)</div>
<div class="line"> </div>
<div class="line">echo_rs = CoapResource(ctx, <span class="stringliteral">&quot;echo&quot;</span>)</div>
<div class="line">echo_rs.addHandler(echo_handler)</div>
<div class="line">ctx.addResource(echo_rs)</div>
<div class="line"> </div>
<div class="line">ctx.loop()</div>
</div><!-- fragment --><p>More examples can be found in the <code>examples</code> directory. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
